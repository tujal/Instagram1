<%= render "/home/nav" %>
<%= render partial: "/posts/flash" %>
<div class="container w-25 mt-4">
<% @posts.reverse.each do |post| %>
    <div class="card" >
        
            <div class="d-flex">
                <div> 
                         <% if post.user.profile_image.attached? %>
                         <%= image_tag(post.user.profile_image, size:"40x40",class:"rounded-circle mt-1") %>  
                        <% else %>
                            <% if post.user.gender == "male" %>
                                    <img src="https://cdn-icons-png.flaticon.com/128/4140/4140077.png", style="width:40px; height:40px" >
                            <% else %>
                                    <img src="https://cdn-icons-png.flaticon.com/128/4140/4140047.png", style="width:40px; height:40px" >
                            <% end %> 
                        <% end %>
                </div>
                <div>
                    <%= link_to  post.user.email, user_profile_path(post.user), class:"text-decoration-none text-dark" %>
                    <small class="text-secondary "> <%= post.location %></small>
                </div>
                <div class="btn-group dropright">
                <button type="button" class="btn btn-white dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        <img src="https://cdn-icons-png.flaticon.com/128/2311/2311524.png" style="width:25px; height:25px" %>
                </button>
                            <div class="dropdown-menu mr-5">
                                <%= link_to "Show QR" ,root_path , class:"dropdown-item" %>
                            </div>
                 </div>
            </div>
            <%= image_tag(post.image , class:"img-fluid" ) if post.image.attached? %>
            <div class="mt-1">
                 <small class="text-secondary ">  <%= time_ago_in_words(post.created_at) %>Ago</small><br>
                 <% pre_like = post.likes.find { |like| like.user_id == current_user.id} %>
                 <% if pre_like %>
                   <%= button_to post_like_path(post, pre_like), method: :delete, class:"bg-white btn btn-link"  do %>
                    <img src="https://cdn-icons-png.flaticon.com/128/833/833472.png", style="width:30px; height:30px">
                    <% end %>
                 <% else %>
                   <%= button_to post_likes_path(post), method: :post, class:"bg-white btn btn-link" do %>
                    <img src="https://cdn-icons-png.flaticon.com/128/1077/1077035.png", style="width:30px; height:30px">
                    <% end %>
                 <% end %>
                    <p><%= post.likes.count %> <%= (post.likes.count) == 1 ? 'Like' : 'Likes'%></p>
                <p class="card-text"><%= link_to post.title, user_post_path(current_user, post) %></p> 
            </div>
            </div>
            </br>
            <% end %>
    </div>
    
  </div>  
